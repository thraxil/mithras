<VirtualHost *:88>
  ServerName www.thraxil.org
	ServerAlias thraxil.org
	ServerAdmin anders@columbia.edu


RewriteEngine On
RewriteRule ^/feeds/atom.xml http://thraxil.org/feeds/main/ [R=301,L]
RewriteRule ^/feeds/index.rss http://thraxil.org/feeds/main/ [R=301,L]
RewriteRule ^/users/(.*)/feeds/atom.xml http://thraxil.org/users/$1/feed/ [R=301,L]
RewriteRule ^/users/(.*)/feeds/index.rss http://thraxil.org/users/$1/feed/ [R=301,L]

RewriteCond %{HTTP_HOST} ^www\.thraxil\.org [NC]
RewriteRule (.*) http://thraxil.org$1 [R=301,L]

DocumentRoot /var/www/thraxil/

CustomLog /var/log/apache2/mithras/access.log combined
ErrorLog /var/log/apache2/mithras/error.log

SetEnv DJANGO_SETTINGS_MODULE mithras.settings_production

Alias /robots.txt /var/www/thraxil/htdocs/robots.txt
Alias /code/ /var/www/thraxil/htdocs/code/
Alias /e3940/ /var/www/thraxil/htdocs/e3940/
Alias /js/ /var/www/thraxil/htdocs/js/
Alias /images/ /var/www/thraxil/htdocs/images/
Alias /mfr/ /var/www/thraxil/htdocs/mfr/
Alias /media/ /var/www/thraxil/mithras/ve/lib/python2.7/site-packages/django/contrib/admin/media/

<Directory /var/www/thraxil/mithras/ve/lib/python2.7/site-packages/django/contrib/admin/media/>
Order deny,allow
Allow from all
</Directory>

Alias /site_media/ /var/www/thraxil/mithras/media/

<Directory /var/www/thraxil/mithras/media/>
Order deny,allow
Allow from all
</Directory>


Alias /uploads/ /var/www/thraxil/data/
<Directory /var/www/thraxil/data/>
Order deny,allow
Allow from all
</Directory>

WSGIDaemonProcess site-mithras user=anders group=anders threads=5 python-path=/var/www/thraxil/mithras/ve/lib/python2.7/site-packages
WSGIProcessGroup site-mithras
WSGIScriptAlias / /var/www/thraxil/mithras/apache/django.wsgi

<Directory /var/www/thraxil/mithras/apache>
Order deny,allow
Allow from all
</Directory>

<Directory /var/www/thraxil/mithras/media/>
    FileETag None
    ExpiresActive on
    ExpiresDefault "access plus 10 years"
    AddOutputFilterByType DEFLATE text/css application/x-javascript
</Directory>

</VirtualHost>

<VirtualHost *:88>
ServerName static.thraxil.org
DocumentRoot /var/www/thraxil/htdocs/
</VirtualHost>


